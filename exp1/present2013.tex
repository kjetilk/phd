%\documentclass[english,aspectratio=169]]{ifislide}
%\documentclass[english,print,aspectratio=169]{ifislide}
\documentclass[english,handout,aspectratio=169]{ifislide}

\usepackage[utf8]{inputenc}
% Packages used specific for this lecture:

%\usepackage{bussproofs}
%\usepackage{textpos}

%\EnableBpAbbreviations
%% \usepackage{tikz}

%% \usetikzlibrary{arrows,shapes,mindmap}
%% \usetikzlibrary{decorations.pathmorphing}
%% \tikzstyle{resource}=[ellipse,draw=black!40,fill=blue!20,thick, font=\ttfamily]
%% \tikzstyle{blank}=[ellipse,draw=black!40,fill=white!40,thick, font=\ttfamily]
%% \tikzstyle{literal}=[rectangle,text centered,draw=black!40,fill=black!20,thick]
%% \tikzstyle{predicate}=[sloped,above,text centered,midway,font={\scriptsize\ttfamily}]
%% \tikzstyle{predicateb}=[left,midway,font={\scriptsize\ttfamily}]
%% \tikzstyle{class}=[rectangle,text centered,draw=black!40,fill=white,thick]
%% \usetikzlibrary{arrows,automata}


\newcommand{\typed}{\char`\^\char`\^}
\newcommand{\blank}{\char`\_}

\newcommand{\tuple}[1]{\left<#1\right>}
\newcommand{\inter}{\mathcal{I}}
\newcommand{\domain}{\mathop{\mathsf{dom}}}
\newcommand{\range}{\mathop{\mathsf{rg}}}

% set lecture number, date, title:
%\LectureNumber{13}
\LectureDate{23.10.2013}
\LectureTitle{Introducing Statistical Design of Experiments to SPARQL Endpoint Evaluation}
% set name of lecturer:
\author{Kjetil Kjernsmo}
\AtBeginSection[]
{
  \begin{frame}
    \frametitle{Outline}
    \tableofcontents[currentsection]
  \end{frame}
}

\begin{document}

\IfiTitleSlide     % inserts title frame

%\IfiTOCSlide       % inserts today's plan frame


\section{Introduction} 

\begin{frame}{Experimental tradition}

Teh Tycho

\end{frame}

\begin{frame}{What's a benchmark?}
\end{frame}
\note{If your queries are all fully known, by all means, run them}
\note{In most scientific relevant cases, no such assumptions can be
  made}

\begin{frame}{Problems with benchmarking}

\begin{itemize}
\item Large number of parameters to test for complex scenarios.
\item No structured approach to investigate flaws.
\item No meaningful summary of the overall performance.
\item Standardized benchmarks cannot test assertions outside of the
  standard.
\item Attempting to neutralize the effect of certain optimization
  techniques oversimplifies the test.
\end{itemize}
\end{frame}
\note{If you standardize hardware, you can't test claims about
  improved hardware. You'd need interactions too}
\note{Cache-buster is evil}

\begin{frame}{Design of Experiments}

  \begin{itemize}
  \item Pioneered by Fischer in the 1930-ties.
  \item Well-established in many fields of engineering, agriculture,
    medicine.
  \item Well-suited to manage very complex experiments.
  \item Requires parameterization of experiments.
  \end{itemize}
\end{frame}
\note{How many is familiar with DoE?}

\subsection{Key Concepts Design of Experiments}

\begin{frame}{Response variable}

% TODO Format well
   A \emph{response variable} is measured under various
    combinations of parameters.

For example:
\begin{itemize}
\item Throughput
\item Query execution time
\item Response time
\end{itemize}

\end{frame}

\begin{frame}{Factor}

Such parameters are called \emph{factor}s. 

For example:
\begin{itemize}
\item A concrete implementation
\item Hardware platform
\item Data heterogeneity
\item Number of triples in the store
\item Absence or presence of certain language features
\item Order of experiments
\end{itemize}

\end{frame}

\begin{frame}{Levels}

For each factor, a range of possible values are fixed. These values
are called \emph{levels}.

For example:
\begin{itemize}
\item For implementation, 4store or Virtuoso.
\item For number of triples, the levels could be 1 or 2 MTriples.
\item For language features, the levels could be \textsf{SELECT} and \textsf{CONSTRUCT}
\end{itemize}

Levels may be continuous, discrete, different instances of a
class, etc.

\end{frame}

\begin{frame}{Design Matrix}

% latex table generated in R 2.15.1 by xtable 1.5-6 package
% Sat Oct  5 22:16:51 2013
\begin{table}[ht]
\begin{center}
\begin{tabular}{r|ccc}
  \hline
 & Implement & TripleC & Union \\ 
  \hline
1 & 2 & 1 & 2 \\ 
  2 & 2 & 2 & 2 \\ 
  3 & 2 & 1 & 1 \\ 
  4 & 1 & 1 & 1 \\ 
  5 & 2 & 2 & 1 \\ 
  6 & 1 & 2 & 1 \\ 
  7 & 1 & 2 & 2 \\ 
  8 & 1 & 1 & 2 \\ 
   \hline
\end{tabular}
\end{center}
\end{table}


\end{frame}
\note{There are 3 factors, 8 experiments, which is $2^3$}

\begin{frame}{Factorial experiments}

  \begin{itemize}
  \item Full factorial experiments:
    \begin{itemize}
    \item 2 levels give $2^n$ combinations (\emph{runs}), where $n$ is
      the number of factors.
    \item 3 levels give $3^n$ runs, etc.
    \end{itemize}
  \item Fractional factorial experiments:

    \begin{itemize}
    \item When experimental economy is important,
    \item DoE theory offers extensive facilities for running a
      fraction of the runs ($2^{n-1}$ etc).
    \item The price is of smaller experiments is explanatory power.
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Main effects}

\emph{Effects} describe the influence of the levels on the response.

The the \emph{main effect}: For a factor $A$ with two levels, we let
$a_1$ and $a_2$ be the average response of all $2^{n-1}$ measurements
with $A$ at level 1, and 2, respectively.  The main effect of $A$ is
then defined as $a_2 - a_1$.

For example: 

For each implementation, average all the responses. Then, the main
effect of the implementation is the difference between them.

\end{frame}

\begin{frame}{Interaction effects}

\emph{Interaction effects} for two factors $AB$ are defined
by comparing averages for equal versus non-equal levels of $A$ and
$B$. 

For example:

For each implementation, find the averages for each dataset size, the
interaction effect is % TODO: Clear example.


In practice, Quite Easily Done using linear regression.
\end{frame}
\note{Interaction effects may be complex, like one implementation is
  better on CONSTRUCT queries, on small datasets}
\note{We still need to understand which effects are important and
  significant, we do that in the discussion of our experiment]

\begin{frame}{Full normal plot}
\begin{figure}[t]
  \centerline{%
  \includegraphics[width=.9\textwidth]{fullnormal.pdf}}
  \caption{A normal plot of the Full Factorial Experiment. The
    labelled points are considered significant by using the Lenth
    criterion at a level $\alpha=0.05$.}\label{fig:fullnormal}
\end{figure}

\end{frame}
\note{Don't worry about the axes}


\begin{frame}
\begin{table}[ht!]
\begin{center}
\caption{$p$-values for different parts of the experiment}\label{tab:pvaluesfull}
\begin{tabular}{cccccl}
  \hline
``TripleC'' & ``BGPComp'' & ``Lang'' & ``Union'' & ``Optional'' & $p$ \\ 
  \hline
  1 & 1 & 1 & 1 & 1 & 0.012 \\ 
  1 & 1 & 1 & 1 & 2 & $1.4 \cdot 10^{-09}$ \\ 
  1 & 1 & 1 & 2 & 1 & $3.1 \cdot 10^{-09}$ \\ 
  1 & 1 & 1 & 2 & 2 & $6.1 \cdot 10^{-11}$ \\ 
  1 & 1 & 2 & 1 & 1 & $3.3 \cdot 10^{-06}$ \\ 
  1 & 1 & 2 & 1 & 2 & $2.7 \cdot 10^{-09}$ \\ 
  1 & 1 & 2 & 2 & 1 & $2 \cdot 10^{-06}$ \\ 
  1 & 1 & 2 & 2 & 2 & $3.6 \cdot 10^{-10}$ \\ 
  1 & 2 & 1 & 1 & 1 & 0.014 \\ 
  1 & 2 & 1 & 1 & 2 & $1.2 \cdot 10^{-10}$ \\ 
  1 & 2 & 1 & 2 & 1 & $2.8 \cdot 10^{-14}$ \\ 
  1 & 2 & 1 & 2 & 2 & $4.1 \cdot 10^{-15}$ \\ 
  1 & 2 & 2 & 1 & 1 & $2.1 \cdot 10^{-05}$ \\ 
  1 & 2 & 2 & 1 & 2 & $2.7 \cdot 10^{-07}$ \\ 
  1 & 2 & 2 & 2 & 1 & 0.0072 \\ 
  1 & 2 & 2 & 2 & 2 & $1.6 \cdot 10^{-05}$ \\ 
  2 & 1 & 1 & 1 & 1 & 0.28 \\ 
  2 & 1 & 1 & 1 & 2 & $3 \cdot 10^{-07}$ \\ 
  2 & 1 & 1 & 2 & 1 & $3.3 \cdot 10^{-07}$ \\ 
  2 & 1 & 1 & 2 & 2 & $1.7 \cdot 10^{-08}$ \\ 
  2 & 1 & 2 & 1 & 1 & 0.0023 \\ 
  2 & 1 & 2 & 1 & 2 & $6.5 \cdot 10^{-07}$ \\ 
  2 & 1 & 2 & 2 & 1 & 0.00032 \\ 
  2 & 1 & 2 & 2 & 2 & $1.3 \cdot 10^{-06}$ \\ 
  2 & 2 & 1 & 1 & 1 & 0.013 \\ 
  2 & 2 & 1 & 1 & 2 & $1 \cdot 10^{-11}$ \\ 
  2 & 2 & 1 & 2 & 1 & $3.8 \cdot 10^{-11}$ \\ 
  2 & 2 & 1 & 2 & 2 & $4.1 \cdot 10^{-15}$ \\ 
  2 & 2 & 2 & 1 & 1 &   1 \\ 
  2 & 2 & 2 & 1 & 2 & $2.3 \cdot 10^{-05}$ \\ 
  2 & 2 & 2 & 2 & 1 &   1 \\ 
  2 & 2 & 2 & 2 & 2 & 0.99 \\ 
   \hline
\end{tabular}
\end{center}
\end{table}

\end{frame}


\end{document}
